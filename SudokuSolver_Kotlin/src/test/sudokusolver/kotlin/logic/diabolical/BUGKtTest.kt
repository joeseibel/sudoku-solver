package sudokusolver.kotlin.logic.diabolical

import org.junit.jupiter.api.Test
import sudokusolver.kotlin.SetValue
import sudokusolver.kotlin.logic.assertLogicalSolution

internal class BUGKtTest {
    /*
     * 1 7 4 | 8 3 2 | 5 9 6
     * 5 9 3 | 4 6 1 | 2 7 8
     * 6 8 2 | 9 5 7 | 0 0 1
     * ------+-------+------
     * 0 6 7 | 5 0 0 | 9 0 0
     * 0 1 9 | 7 0 3 | 6 0 5
     * 4 3 5 | 0 9 6 | 8 0 7
     * ------+-------+------
     * 3 0 1 | 6 0 0 | 7 5 9
     * 9 0 8 | 0 7 5 | 0 6 0
     * 7 5 6 | 3 0 9 | 0 8 2
     */
    @Test
    fun testBug1() {
        val board = """
            174832596
            593461278
            682957{34}{34}1
            {28}675{12}{48}9{123}{34}
            {28}197{48}36{24}5
            435{12}968{12}7
            3{24}16{28}{48}759
            9{24}8{12}75{13}6{34}
            7563{14}9{14}82
        """.trimIndent().replace("\n", "")
        val expected = listOf(
            SetValue(3, 7, 2)
        )
        assertLogicalSolution(expected, board) { listOfNotNull(bug(it)) }
    }

    /*
     * 8 2 1 | 0 0 0 | 7 4 6
     * 7 3 6 | 0 0 0 | 9 1 5
     * 5 4 9 | 0 0 0 | 3 8 2
     * ------+-------+------
     * 0 0 0 | 0 7 8 | 2 0 0
     * 0 0 0 | 5 2 0 | 0 0 0
     * 2 0 0 | 1 3 9 | 0 0 4
     * ------+-------+------
     * 3 9 2 | 0 0 0 | 5 6 8
     * 6 8 4 | 0 0 0 | 1 3 7
     * 1 5 7 | 0 0 0 | 4 2 9
     */
    @Test
    fun testBug2() {
        val board = """
            821{39}{59}{35}746
            736{28}{48}{24}915
            549{67}{16}{17}382
            {49}{16}{35}{46}782{59}{13}
            {49}{167}{38}52{46}{68}{79}{13}
            2{67}{58}139{68}{57}4
            392{47}{14}{17}568
            684{29}{59}{25}137
            157{38}{68}{36}429
        """.trimIndent().replace("\n", "")
        val expected = listOf(
            SetValue(4, 1, 6)
        )
        assertLogicalSolution(expected, board) { listOfNotNull(bug(it)) }
    }

    /*
     * 2 8 9 | 4 7 6 | 5 3 1
     * 7 5 1 | 2 3 8 | 4 9 6
     * 4 3 6 | 9 1 5 | 7 2 8
     * ------+-------+------
     * 9 7 0 | 0 0 2 | 0 4 3
     * 3 6 0 | 0 9 4 | 0 0 5
     * 1 4 0 | 0 0 3 | 0 0 9
     * ------+-------+------
     * 5 9 4 | 8 2 1 | 3 6 7
     * 6 2 7 | 3 5 9 | 8 1 4
     * 8 1 3 | 6 4 7 | 9 5 2
     */
    @Test
    fun testBug3() {
        val board = """
            289476531
            751238496
            436915728
            97{58}{15}{68}2{16}43
            36{28}{17}94{12}{78}5
            14{258}{57}{68}3{26}{78}9
            594821367
            627359814
            813647952
        """.trimIndent().replace("\n", "")
        val expected = listOf(
            SetValue(5, 2, 8)
        )
        assertLogicalSolution(expected, board) { listOfNotNull(bug(it)) }
    }

    /*
     * 1 4 2 | 8 9 5 | 7 6 3
     * 0 0 6 | 2 0 3 | 0 1 0
     * 0 0 3 | 6 1 0 | 0 0 2
     * ------+-------+------
     * 8 6 7 | 1 2 9 | 3 0 0
     * 3 5 1 | 4 0 0 | 8 2 9
     * 9 2 4 | 5 3 8 | 6 7 1
     * ------+-------+------
     * 6 7 0 | 3 0 1 | 2 9 0
     * 2 3 0 | 9 0 0 | 1 0 7
     * 4 1 9 | 7 8 2 | 5 3 6
     */
    @Test
    fun testBug4() {
        val board = """
            142895763
            {57}{89}62{47}3{49}1{58}
            {57}{89}361{47}{49}{58}2
            8671293{45}{45}
            3514{67}{67}829
            924538671
            67{58}3{45}129{48}
            23{58}9{456}{46}1{48}7
            419782536
        """.trimIndent().replace("\n", "")
        val expected = listOf(
            SetValue(7, 4, 4)
        )
        assertLogicalSolution(expected, board) { listOfNotNull(bug(it)) }
    }

    /*
     * 4 0 0 | 5 6 0 | 1 2 7
     * 0 0 0 | 4 1 3 | 8 5 9
     * 0 5 1 | 7 2 0 | 6 4 3
     * ------+-------+------
     * 0 0 0 | 2 9 7 | 0 1 8
     * 1 0 8 | 6 3 5 | 9 7 0
     * 0 9 0 | 1 8 4 | 0 3 6
     * ------+-------+------
     * 3 0 0 | 0 5 1 | 0 6 0
     * 2 1 4 | 0 7 6 | 3 0 5
     * 0 6 5 | 3 4 2 | 7 0 1
     */
    @Test
    fun testBug5() {
        val board = """
            4{38}{39}56{89}127
            {67}{27}{267}413859
            {89}5172{89}643
            {56}{34}{36}297{45}18
            1{24}863597{24}
            {57}9{27}184{25}36
            3{78}{79}{89}51{24}6{24}
            214{89}763{89}5
            {89}653427{89}1
        """.trimIndent().replace("\n", "")
        val expected = listOf(
            SetValue(1, 2, 7)
        )
        assertLogicalSolution(expected, board) { listOfNotNull(bug(it)) }
    }

    /*
     * 8 9 1 | 5 0 7 | 0 6 0
     * 4 2 5 | 6 3 1 | 7 8 9
     * 6 7 3 | 9 0 8 | 0 0 1
     * ------+-------+------
     * 5 6 0 | 7 0 9 | 0 3 0
     * 3 1 0 | 0 0 0 | 0 7 0
     * 7 8 0 | 4 0 3 | 0 0 6
     * ------+-------+------
     * 1 0 7 | 0 0 0 | 2 9 0
     * 9 0 6 | 0 7 0 | 0 1 8
     * 2 3 8 | 1 9 5 | 6 4 7
     */
    @Test
    fun testBug6() {
        val board = """
            8915{24}7{34}6{23}
            425631789
            6739{24}8{45}{25}1
            56{24}7{18}9{18}3{24}
            31{49}{28}{568}{26}{89}7{45}
            78{29}4{15}3{19}{25}6
            1{45}7{38}{68}{46}29{35}
            9{45}6{23}7{24}{35}18
            238195647
        """.trimIndent().replace("\n", "")
        val expected = listOf(
            SetValue(4, 4, 8)
        )
        assertLogicalSolution(expected, board) { listOfNotNull(bug(it)) }
    }

    /*
     * 0 0 9 | 0 1 2 | 3 7 6
     * 0 0 3 | 8 9 0 | 4 1 2
     * 0 0 1 | 3 7 0 | 5 9 8
     * ------+-------+------
     * 3 4 6 | 2 8 7 | 9 5 1
     * 1 0 0 | 6 3 9 | 0 0 0
     * 0 0 7 | 0 0 1 | 6 2 3
     * ------+-------+------
     * 0 3 8 | 9 2 0 | 1 6 0
     * 0 0 0 | 1 6 3 | 0 0 5
     * 6 1 0 | 7 0 8 | 2 3 9
     */
    @Test
    fun testBug7() {
        val board = """
            {48}{58}9{45}12376
            {57}{67}389{56}412
            {24}{26}137{46}598
            346287951
            1{25}{25}639{78}{48}{47}
            {89}{89}7{45}{45}1623
            {57}3892{45}16{47}
            {29}{279}{24}163{78}{48}5
            61{45}7{45}8239
        """.trimIndent().replace("\n", "")
        val expected = listOf(
            SetValue(7, 1, 2)
        )
        assertLogicalSolution(expected, board) { listOfNotNull(bug(it)) }
    }

    /*
     * 9 1 6 | 0 0 8 | 5 2 0
     * 7 4 5 | 1 0 2 | 0 9 8
     * 3 8 2 | 9 0 5 | 7 1 0
     * ------+-------+------
     * 1 3 4 | 0 0 9 | 0 5 2
     * 6 7 0 | 2 5 1 | 0 4 0
     * 2 5 0 | 0 0 3 | 1 7 0
     * ------+-------+------
     * 4 2 7 | 8 1 6 | 9 3 5
     * 8 9 3 | 5 2 7 | 4 6 1
     * 5 6 1 | 3 9 4 | 2 8 7
     */
    @Test
    fun testBug8() {
        val board = """
            916{47}{347}852{34}
            7451{36}2{36}98
            3829{46}571{46}
            134{67}{78}9{68}52
            67{89}251{38}4{39}
            25{89}{46}{48}317{69}
            427816935
            893527461
            561394287
        """.trimIndent().replace("\n", "")
        val expected = listOf(
            SetValue(0, 4, 4)
        )
        assertLogicalSolution(expected, board) { listOfNotNull(bug(it)) }
    }
}